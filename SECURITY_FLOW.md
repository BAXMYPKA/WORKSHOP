# SECURITY: AUTHENTICATION AND AUTHORIZATION FLOW IN A NUTSHELL

* Важно! Все заявленные функции работают полноценно в боевом режиме.

##AUTHENTICATION PROCESS

Каждое обращение пользователя к сайту проходит через фильтры безопасности.

Общий доступ разрешен ко всем страницам внешнего приложения, а также к странице логина внутреннего.

####ДЛЯ ЗАРЕГИСТРИРОВАННЫХ ПОЛЬЗОВАТЕЛЕЙ
После успешного логина приложение генерирует самовыписанный [JWT token](https://jwt.io/) и в ответе пошлет пользователю куку "workshopAuthentication", содержащую в себе данный JWT-токен, каковую куку с токеном впоследствии и будет проверять при каждом обращении.

Непоторые страницы (полноценное управление профилем, просмотр саоих заказов и т.п.) доступны только после входа на сайт.
 
Страница профиля полноценно функционирует.
 
Если пользователь забыл пароль, в специальной форме он может заказать себе на почту уникальную ссылку для его смены.

####ПРОЦЕСС РЕГИСТРАЦИИ
При вводе данных они проходят предварительную проверку при вводе, а потом более полную при отсылке на сервер.

Есть (почти) полностью готовый сервис для отправки новым пользователям писем с уникальным кодом для подтверждения регистрации, которые  сейчас просто отдаются в виде готовой ссылки на странице.

Ссылка активирует профиль пользователя. Если активация не произошла - профиль и ссылка сгорают через сутки.

-----------

##AUTHORIZATION PROCESS
<ul>
    <li>
    Каждая сущность приложения имеет свой тип (<b>WorkshopEntityType</b>) просто по своему названию: <b>Order</b>, <b>Task</b>, <b>User</b> etc.
    </li>
    <li>
    <p>Базовые разрешения (<b>AuthorityPermissions</b>) для доступа к каждой сущности приложения основаны на Http-протоколах: <b>GET</b> (Read), <b>PUT</b> (Write), <b>POST</b> (Create), <b>DELETE</b> (Delete).</p>
    <p>Каждое созданное разрешение включает тип доступа и набор сущностей для данного типа. Например, AuthorityPermission "PUT (Order, Classifier)" позволяет вносить правки в Заказы и Классификаторы.</p>
    </li>
    <li>
    <p>Набор таких разрешений группируется в отдельные Разрешения (<b>InternalAuthorities</b> для сотрудников и <b>ExternalAuthorities</b> для пользователей).</p>
    <p>Например, <b>InternalAuthority</b> "<b>HR_WRITE</b>" будет включать в себя предварительно созданное разрешение <b>"PUT (Order, Classifier)"</b> и <b>"GET (Order, Classifier, User, Task)"</b>, что поволит ему вностить правки в Заказы и Классификаторы, а также просто читать данные отдельных Задач и Пользователей.</p>
    </li>
    <li>
    <p>Ну и набор таких <b>InternalAuthorities</b> раздается для каждой должности (<b>Position</b>) сотрудников, в соответствии с каковым набором сотрудники разных должностей видят или не видят те или иные сущности.</p>
    <p><b>ExternalAuthorities</b> же раздаются подобными наборами для каждого внешнего Пользователя.</p>
    </li>
</ul>

[ВЕРНУТЬСЯ НА ГЛАВНУЮ](https://github.com/BAXMYPKA/WORKSHOP)

